### 分布式网关

#### Zuul

#### Spring Cloud Gateway

#### Nginx

#### Kong

> 微服务API网关，基于OpenResty实现，使用Cassandra或PostgreSQL存储数据

##### Kong特性

* RESTful Admin API: 管理API
* Kong插件，支持插件扩展，`内置丰富的插件`
* Kong数据存储: Cassandra、PostgreSQL
* Kong请求处理: OpenResty
* Kong集群: Gossip协议

##### Kong内置插件

* Authentication: 身份认证插件，支持JWT、OAuth2.0等
* Security: 安全控制插件
* Traffic Control: 流量控制插件，限流
* Analytics & Monitoring: 分析监控插件，支持Zipkin等
* Transformations: 协议转换插件，请求转换、响应转换
* Logging: 日志插件，支持文件、Kafka、Http、TCP等
* Serverless: Serverless插件，支持AWS、Azure等
* Deployment: 部署插件，支持AWS、Azure等

##### Kong负载均衡

> Route(请求路由) -> Service(服务) -> Upstream(负载均衡) -> Target(节点)

```http
# 创建upstream
curl -X POST http://127.0.0.1:8001/upstreams --data "name=demo-upstream"
# 配置upstream
curl -X POST http://127.0.0.1:8001/upstreams/demo-upstream/targets --data "target=10.8.8.34:18080" --data "weight=100"
curl -X POST http://127.0.0.1:8001/upstreams/demo-upstream/targets --data "target=10.8.8.34:28080" --data "weight=50"

# 创建Service
curl -X POST http://127.0.0.1:8001/services --data "name=demo-service" --data "host=demo-upstream"

# 创建Route
curl -X POST http://localhost:8001/services/demo-service/routes --data "name=demo-route" --data "paths[]=/demo-api"

# 网关访问
curl http://127.0.0.1:8000/demo-api/index/test
```


[<< 上一篇: 服务注册与发现](4-分布式/服务注册与发现.md)

[>> 下一篇: 分布式ID](4-分布式/分布式ID.md)
