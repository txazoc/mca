### 分布式事务

#### 分布式事务由来

> 微服务化和数据库拆分后，一个操作涉及多个服务、多个数据库

#### 两/三阶段提交协议(2PC/3PC)

#### TCC事务

#### 可靠消息

> 

##### 本地消息表

* 服务A，本地事务写业务表和本地消息表
* 服务A，发送消息到MQ
* 服务B，幂等消费服务A的消息，处理完成后，通过RPC或MQ通知服务A更新本地消息表中消息状态
* 服务A，另启定时任务，定时扫描本地消息表中未完成的消息，重新投递到MQ

**缺点**

* 本地消息表和业务耦合，难以通用
* 本地消息表有性能瓶颈

##### RocketMQ分布式事务
